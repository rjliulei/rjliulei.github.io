---
layout: post 
category: "Android" 
title:  "T9键盘检索联系人" 
tags: [Android]
---

### 一、需求：
支持数字拼音简拼全拼

### 二、几种实现方式：
* 1.lucene全文检索引擎，完全开源的，稍微有点大
* 2.自设计算法实现，使用第三方拼音库
我使用的是自实现算法，使用部分正则匹配。

### 三、难点：
* 1.多音字的处理

### 四、流程：
* 1.根据姓名与电话号码创建索引
* 2.根据t9匹配
* 3.返回高亮结果

### 五、实现思路：
* 1.制作索引（声母、全拼、号码）
* 1.1.根据联系人姓名得到声母、全拼以及号码，制作出联系人索引列表
* 1.2.基于匹配速度的考虑，首个中文考虑多音，其余不考虑

* 2.匹配原则
* 2.1.分三层匹配：声母、全拼（包括非汉字）、电话号码
* 2.2.优先级：声母>全拼>电话号码，即有一种匹配成功即不再进行其他匹配
* 2.3.特殊字符匹配：0、1、
* 2.4.只进行连续匹配
* 2.5.借助首字母大写，进行全拼匹配
* 2.6.排序：匹配位置加权
* 2.7.关键字只有一个时不进行全拼匹配，匹配成功后通过判断首字母大写

* 3.高亮原则：
* 3.1.匹配过程中直接生成
* 3.2.根据声母表位置可以获取全拼列表中的全拼，根据首字母大写循环高亮

### 六、可优化的地方：
* 1.制作出的索引本地化

### 七、Model类设计：
单个汉字：原字符、拼音列表、声母列表、是否是拼音、开始位置
联系人列表项：汉字列表、全拼列表、简拼列表、高亮全拼、名称、电话号码

### 参考资料：
也是用的正则：http://blog.csdn.net/wwj_748/article/details/17238843
自定义的算法：https://github.com/handsomezhou/T9SearchLibrary
lucene库（代码比较大。。。）：https://github.com/weiweiwang/quickdialer
源代码：https://github.com/rjliulei/T9SearchReg
